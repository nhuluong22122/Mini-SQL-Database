TEST1.sh - test driver for CS157B project
Compile your code
In file included from db.cpp:5:
./db.h:151:3: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "int", "char", "varchar", "create", "table", "not", "null", "drop", "list", "schema",
  ^
./db.h:151:10: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "int", "char", "varchar", "create", "table", "not", "null", "drop", "list", "schema",
         ^
./db.h:151:18: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "int", "char", "varchar", "create", "table", "not", "null", "drop", "list", "schema",
                 ^
./db.h:151:29: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "int", "char", "varchar", "create", "table", "not", "null", "drop", "list", "schema",
                            ^
./db.h:151:39: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "int", "char", "varchar", "create", "table", "not", "null", "drop", "list", "schema",
                                      ^
./db.h:151:48: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "int", "char", "varchar", "create", "table", "not", "null", "drop", "list", "schema",
                                               ^
./db.h:151:55: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "int", "char", "varchar", "create", "table", "not", "null", "drop", "list", "schema",
                                                      ^
./db.h:151:63: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "int", "char", "varchar", "create", "table", "not", "null", "drop", "list", "schema",
                                                              ^
./db.h:151:71: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "int", "char", "varchar", "create", "table", "not", "null", "drop", "list", "schema",
                                                                      ^
./db.h:151:79: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "int", "char", "varchar", "create", "table", "not", "null", "drop", "list", "schema",
                                                                              ^
./db.h:152:3: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "for", "to", "insert", "into", "values", "delete", "from", "where",
  ^
./db.h:152:10: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "for", "to", "insert", "into", "values", "delete", "from", "where",
         ^
./db.h:152:16: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "for", "to", "insert", "into", "values", "delete", "from", "where",
               ^
./db.h:152:26: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "for", "to", "insert", "into", "values", "delete", "from", "where",
                         ^
./db.h:152:34: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "for", "to", "insert", "into", "values", "delete", "from", "where",
                                 ^
./db.h:152:44: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "for", "to", "insert", "into", "values", "delete", "from", "where",
                                           ^
./db.h:152:54: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "for", "to", "insert", "into", "values", "delete", "from", "where",
                                                     ^
./db.h:152:62: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "for", "to", "insert", "into", "values", "delete", "from", "where",
                                                             ^
./db.h:153:3: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "update", "set", "select", "order", "by", "desc", "is", "and", "or",
  ^
./db.h:153:13: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "update", "set", "select", "order", "by", "desc", "is", "and", "or",
            ^
./db.h:153:20: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "update", "set", "select", "order", "by", "desc", "is", "and", "or",
                   ^
./db.h:153:30: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "update", "set", "select", "order", "by", "desc", "is", "and", "or",
                             ^
./db.h:153:39: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "update", "set", "select", "order", "by", "desc", "is", "and", "or",
                                      ^
./db.h:153:45: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "update", "set", "select", "order", "by", "desc", "is", "and", "or",
                                            ^
./db.h:153:53: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "update", "set", "select", "order", "by", "desc", "is", "and", "or",
                                                    ^
./db.h:153:59: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "update", "set", "select", "order", "by", "desc", "is", "and", "or",
                                                          ^
./db.h:153:66: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "update", "set", "select", "order", "by", "desc", "is", "and", "or",
                                                                 ^
./db.h:154:3: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "sum", "avg", "count"
  ^
./db.h:154:10: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "sum", "avg", "count"
         ^
./db.h:154:17: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "sum", "avg", "count"
                ^
db.cpp:164:28: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
                                        add_to_list(tok_list, "", terminator, EOC);
                                                              ^
db.cpp:194:28: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
                                        add_to_list(tok_list, "", terminator, EOC);
                                                              ^
db.cpp:221:27: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
                                add_to_list(tok_list, "", terminator, EOC);
                                                      ^
db.cpp:251:28: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
                                        add_to_list(tok_list, "", terminator, EOC);
                                                              ^
db.cpp:260:27: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
                                add_to_list(tok_list, "", terminator, EOC);
                                                      ^
db.cpp:667:36: warning: format specifies type 'int' but the argument has type 'off_t' (aka 'long long') [-Wformat]
                printf("dbfile.bin size = %d\n", file_stat.st_size);
                                          ~~     ^~~~~~~~~~~~~~~~~
                                          %lld
36 warnings generated.
Clean up
==========================================================================================
01 Test setup - create table + insert data
CREATE TABLE statement
==========================================================================================
02 Insert 15 rows of data
dbfile.bin size = 228
INSERT statement
class.tab size: 64. Number of records: 1
dbfile.bin size = 228
INSERT statement
class.tab size: 104. Number of records: 2
dbfile.bin size = 228
INSERT statement
class.tab size: 144. Number of records: 3
dbfile.bin size = 228
INSERT statement
class.tab size: 184. Number of records: 4
dbfile.bin size = 228
INSERT statement
class.tab size: 224. Number of records: 5
dbfile.bin size = 228
INSERT statement
class.tab size: 264. Number of records: 6
dbfile.bin size = 228
INSERT statement
class.tab size: 304. Number of records: 7
dbfile.bin size = 228
INSERT statement
class.tab size: 344. Number of records: 8
dbfile.bin size = 228
INSERT statement
class.tab size: 384. Number of records: 9
dbfile.bin size = 228
INSERT statement
class.tab size: 424. Number of records: 10
dbfile.bin size = 228
INSERT statement
class.tab size: 464. Number of records: 11
dbfile.bin size = 228
INSERT statement
class.tab size: 504. Number of records: 12
dbfile.bin size = 228
INSERT statement
class.tab size: 544. Number of records: 13
dbfile.bin size = 228
INSERT statement
class.tab size: 584. Number of records: 14
dbfile.bin size = 228
INSERT statement
class.tab size: 624. Number of records: 15
------------------------------------------------------------------------------------------
01: Simple select class.tab db db.cpp db.h dbfile.bin test.out test.sh test2.sh
test2.sh: line 32: verify: command not found
test2.sh: line 32: verify: command not found
dbfile.bin size = 228
SELECT statement
+--------------------+--------------------+--------------------+--------------------+--------------------+
|Student_Name        |Gender              |Exams               |Quiz_Total          |Total               |
+--------------------+--------------------+--------------------+--------------------+--------------------+
|Siu                 |M                   |                 480|                  80|                 560|
|Frank               |M                   |                 600|                 100|                 700|
|Jordon              |M                   |                 450|                  75|                 525|
|Jeff                |M                   |                 455|                  60|                 515|
|Ying                |F                   |                 540|                  85|                 625|
|David               |M                   |                 550|                  83|                 633|
|euna                |F                   |                 460|                  75|                 535|
|Victor              |M                   |                 475|                  60|                 535|
|Linawati            |F                   |                 490|                  86|                 576|
|Stephen             |M                   |                 520|                  76|                 596|
|Melody              |F                   |                 560|                  83|                 633|
|Travis              |M                   |                 600|                  75|                 534|
|Sherry              |F                   |                 610|                  94|                 647|
|Hector              |M                   |                 590|                  86|                 482|
|Natalie             |F                   |                 500|                  54|                 596|
+--------------------+--------------------+--------------------+--------------------+--------------------+
15 rows selected.
==========================================================================================
02: Delete from class where Student_Name = Bad_Student
dbfile.bin size = 228
DELETE statement
Delete 1 rows. 
dbfile.bin size = 228
SELECT statement
+--------------------+--------------------+--------------------+--------------------+--------------------+
|Student_Name        |Gender              |Exams               |Quiz_Total          |Total               |
+--------------------+--------------------+--------------------+--------------------+--------------------+
|Siu                 |M                   |                 480|                  80|                 560|
|Frank               |M                   |                 600|                 100|                 700|
|Jordon              |M                   |                 450|                  75|                 525|
|Jeff                |M                   |                 455|                  60|                 515|
|Ying                |F                   |                 540|                  85|                 625|
|David               |M                   |                 550|                  83|                 633|
|euna                |F                   |                 460|                  75|                 535|
|Victor              |M                   |                 475|                  60|                 535|
|Linawati            |F                   |                 490|                  86|                 576|
|Natalie             |F                   |                 500|                  54|                 596|
|Melody              |F                   |                 560|                  83|                 633|
|Travis              |M                   |                 600|                  75|                 534|
|Sherry              |F                   |                 610|                  94|                 647|
|Hector              |M                   |                 590|                  86|                 482|
+--------------------+--------------------+--------------------+--------------------+--------------------+
14 rows selected.
delete from class where Student_Name = Stephen
==========================================================================================
03: Delete from class where no row is found
dbfile.bin size = 228
Invalid statement
dbfile.bin size = 228
SELECT statement
+--------------------+--------------------+--------------------+--------------------+--------------------+
|Student_Name        |Gender              |Exams               |Quiz_Total          |Total               |
+--------------------+--------------------+--------------------+--------------------+--------------------+
|Siu                 |M                   |                 480|                  80|                 560|
|Frank               |M                   |                 600|                 100|                 700|
|Jordon              |M                   |                 450|                  75|                 525|
|Jeff                |M                   |                 455|                  60|                 515|
|Ying                |F                   |                 540|                  85|                 625|
|David               |M                   |                 550|                  83|                 633|
|euna                |F                   |                 460|                  75|                 535|
|Victor              |M                   |                 475|                  60|                 535|
|Linawati            |F                   |                 490|                  86|                 576|
|Natalie             |F                   |                 500|                  54|                 596|
|Melody              |F                   |                 560|                  83|                 633|
|Travis              |M                   |                 600|                  75|                 534|
|Sherry              |F                   |                 610|                  94|                 647|
|Hector              |M                   |                 590|                  86|                 482|
+--------------------+--------------------+--------------------+--------------------+--------------------+
14 rows selected.
delte from class where Student_Name = Hi
==========================================================================================
04: Delete multi-row 3 rows
dbfile.bin size = 228
DELETE statement
Delete 0 rows. 
dbfile.bin size = 228
SELECT statement
+--------------------+--------------------+--------------------+--------------------+--------------------+
|Student_Name        |Gender              |Exams               |Quiz_Total          |Total               |
+--------------------+--------------------+--------------------+--------------------+--------------------+
|Siu                 |M                   |                 480|                  80|                 560|
|Frank               |M                   |                 600|                 100|                 700|
|Jordon              |M                   |                 450|                  75|                 525|
|Jeff                |M                   |                 455|                  60|                 515|
|Ying                |F                   |                 540|                  85|                 625|
|David               |M                   |                 550|                  83|                 633|
|euna                |F                   |                 460|                  75|                 535|
|Victor              |M                   |                 475|                  60|                 535|
|Linawati            |F                   |                 490|                  86|                 576|
|Natalie             |F                   |                 500|                  54|                 596|
|Melody              |F                   |                 560|                  83|                 633|
|Travis              |M                   |                 600|                  75|                 534|
|Sherry              |F                   |                 610|                  94|                 647|
|Hector              |M                   |                 590|                  86|                 482|
+--------------------+--------------------+--------------------+--------------------+--------------------+
14 rows selected.
test2.sh: line 50: 75: No such file or directory
==========================================================================================
05: Test single row update, e.g. update class set Quiz_Total=350 where Student_Name=’David’.
dbfile.bin size = 228
UPDATE statement
Updated 1 rows.
dbfile.bin size = 228
SELECT statement
+--------------------+--------------------+--------------------+--------------------+--------------------+
|Student_Name        |Gender              |Exams               |Quiz_Total          |Total               |
+--------------------+--------------------+--------------------+--------------------+--------------------+
|Siu                 |M                   |                 480|                  80|                 560|
|Frank               |M                   |                 600|                 100|                 700|
|Jordon              |M                   |                 450|                  75|                 525|
|Jeff                |M                   |                 455|                  60|                 515|
|Ying                |F                   |                 540|                  85|                 625|
|David               |M                   |                 550|                  83|                 633|
|euna                |F                   |                 460|                  75|                 535|
|Victor              |M                   |                 475|                  60|                 535|
|Linawati            |F                   |                 490|                  86|                 576|
|Natalie             |F                   |                 500|                 350|                 596|
|Melody              |F                   |                 560|                  83|                 633|
|Travis              |M                   |                 600|                  75|                 534|
|Sherry              |F                   |                 610|                  94|                 647|
|Hector              |M                   |                 590|                  86|                 482|
+--------------------+--------------------+--------------------+--------------------+--------------------+
14 rows selected.
update class set Quiz_Total = 350 where Student_Name = Natalie
==========================================================================================
06: Test update when no rows is found
dbfile.bin size = 228
UPDATE statement
Updated 0 rows.
dbfile.bin size = 228
SELECT statement
+--------------------+--------------------+--------------------+--------------------+--------------------+
|Student_Name        |Gender              |Exams               |Quiz_Total          |Total               |
+--------------------+--------------------+--------------------+--------------------+--------------------+
|Siu                 |M                   |                 480|                  80|                 560|
|Frank               |M                   |                 600|                 100|                 700|
|Jordon              |M                   |                 450|                  75|                 525|
|Jeff                |M                   |                 455|                  60|                 515|
|Ying                |F                   |                 540|                  85|                 625|
|David               |M                   |                 550|                  83|                 633|
|euna                |F                   |                 460|                  75|                 535|
|Victor              |M                   |                 475|                  60|                 535|
|Linawati            |F                   |                 490|                  86|                 576|
|Natalie             |F                   |                 500|                 350|                 596|
|Melody              |F                   |                 560|                  83|                 633|
|Travis              |M                   |                 600|                  75|                 534|
|Sherry              |F                   |                 610|                  94|                 647|
|Hector              |M                   |                 590|                  86|                 482|
+--------------------+--------------------+--------------------+--------------------+--------------------+
14 rows selected.
update class set Quiz_Total = 350 where Student_Name = Nhu
==========================================================================================
07: Multi-row update 4 rows
dbfile.bin size = 228
UPDATE statement
Updated 2 rows.
dbfile.bin size = 228
SELECT statement
+--------------------+--------------------+--------------------+--------------------+--------------------+
|Student_Name        |Gender              |Exams               |Quiz_Total          |Total               |
+--------------------+--------------------+--------------------+--------------------+--------------------+
|Siu                 |M                   |                 480|                  80|                 560|
|Frank               |M                   |                 600|                 350|                 700|
|Jordon              |M                   |                 450|                  75|                 525|
|Jeff                |M                   |                 455|                  60|                 515|
|Ying                |F                   |                 540|                  85|                 625|
|David               |M                   |                 550|                  83|                 633|
|euna                |F                   |                 460|                  75|                 535|
|Victor              |M                   |                 475|                  60|                 535|
|Linawati            |F                   |                 490|                  86|                 576|
|Natalie             |F                   |                 500|                 350|                 596|
|Melody              |F                   |                 560|                  83|                 633|
|Travis              |M                   |                 600|                  75|                 534|
|Sherry              |F                   |                 610|                  94|                 647|
|Hector              |M                   |                 590|                  86|                 482|
+--------------------+--------------------+--------------------+--------------------+--------------------+
14 rows selected.
