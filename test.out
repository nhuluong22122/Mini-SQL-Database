TEST1.sh - test driver for CS157B project
Compile your code
In file included from db.cpp:5:
./db.h:150:3: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "int", "char", "varchar", "create", "table", "not", "null", "drop", "list", "schema",
  ^
./db.h:150:10: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "int", "char", "varchar", "create", "table", "not", "null", "drop", "list", "schema",
         ^
./db.h:150:18: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "int", "char", "varchar", "create", "table", "not", "null", "drop", "list", "schema",
                 ^
./db.h:150:29: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "int", "char", "varchar", "create", "table", "not", "null", "drop", "list", "schema",
                            ^
./db.h:150:39: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "int", "char", "varchar", "create", "table", "not", "null", "drop", "list", "schema",
                                      ^
./db.h:150:48: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "int", "char", "varchar", "create", "table", "not", "null", "drop", "list", "schema",
                                               ^
./db.h:150:55: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "int", "char", "varchar", "create", "table", "not", "null", "drop", "list", "schema",
                                                      ^
./db.h:150:63: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "int", "char", "varchar", "create", "table", "not", "null", "drop", "list", "schema",
                                                              ^
./db.h:150:71: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "int", "char", "varchar", "create", "table", "not", "null", "drop", "list", "schema",
                                                                      ^
./db.h:150:79: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "int", "char", "varchar", "create", "table", "not", "null", "drop", "list", "schema",
                                                                              ^
./db.h:151:3: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "for", "to", "insert", "into", "values", "delete", "from", "where",
  ^
./db.h:151:10: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "for", "to", "insert", "into", "values", "delete", "from", "where",
         ^
./db.h:151:16: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "for", "to", "insert", "into", "values", "delete", "from", "where",
               ^
./db.h:151:26: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "for", "to", "insert", "into", "values", "delete", "from", "where",
                         ^
./db.h:151:34: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "for", "to", "insert", "into", "values", "delete", "from", "where",
                                 ^
./db.h:151:44: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "for", "to", "insert", "into", "values", "delete", "from", "where",
                                           ^
./db.h:151:54: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "for", "to", "insert", "into", "values", "delete", "from", "where",
                                                     ^
./db.h:151:62: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "for", "to", "insert", "into", "values", "delete", "from", "where",
                                                             ^
./db.h:152:3: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "update", "set", "select", "order", "by", "desc", "is", "and", "or",
  ^
./db.h:152:13: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "update", "set", "select", "order", "by", "desc", "is", "and", "or",
            ^
./db.h:152:20: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "update", "set", "select", "order", "by", "desc", "is", "and", "or",
                   ^
./db.h:152:30: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "update", "set", "select", "order", "by", "desc", "is", "and", "or",
                             ^
./db.h:152:39: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "update", "set", "select", "order", "by", "desc", "is", "and", "or",
                                      ^
./db.h:152:45: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "update", "set", "select", "order", "by", "desc", "is", "and", "or",
                                            ^
./db.h:152:53: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "update", "set", "select", "order", "by", "desc", "is", "and", "or",
                                                    ^
./db.h:152:59: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "update", "set", "select", "order", "by", "desc", "is", "and", "or",
                                                          ^
./db.h:152:66: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "update", "set", "select", "order", "by", "desc", "is", "and", "or",
                                                                 ^
./db.h:153:3: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "sum", "avg", "count"
  ^
./db.h:153:10: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "sum", "avg", "count"
         ^
./db.h:153:17: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
  "sum", "avg", "count"
                ^
db.cpp:164:28: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
                                        add_to_list(tok_list, "", terminator, EOC);
                                                              ^
db.cpp:194:28: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
                                        add_to_list(tok_list, "", terminator, EOC);
                                                              ^
db.cpp:221:27: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
                                add_to_list(tok_list, "", terminator, EOC);
                                                      ^
db.cpp:251:28: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
                                        add_to_list(tok_list, "", terminator, EOC);
                                                              ^
db.cpp:260:27: warning: conversion from string literal to 'char *' is deprecated [-Wc++11-compat-deprecated-writable-strings]
                                add_to_list(tok_list, "", terminator, EOC);
                                                      ^
db.cpp:648:36: warning: format specifies type 'int' but the argument has type 'off_t' (aka 'long long') [-Wformat]
                printf("dbfile.bin size = %d\n", file_stat.st_size);
                                          ~~     ^~~~~~~~~~~~~~~~~
                                          %lld
db.cpp:1250:62: warning: '&&' within '||' [-Wlogical-op-parentheses]
                          if(cur->tok_value == S_RIGHT_PAREN && i != new_entry->num_columns - 1
                             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
db.cpp:1250:62: note: place parentheses around the '&&' expression to silence this warning
                          if(cur->tok_value == S_RIGHT_PAREN && i != new_entry->num_columns - 1
                                                             ^
                             (                                                                 )
db.cpp:1251:65: warning: '&&' within '||' [-Wlogical-op-parentheses]
                             || cur->tok_value != S_RIGHT_PAREN && i == new_entry->num_columns - 1)
                             ~~ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
db.cpp:1251:65: note: place parentheses around the '&&' expression to silence this warning
                             || cur->tok_value != S_RIGHT_PAREN && i == new_entry->num_columns - 1)
                                                                ^
                                (                                                                 )
db.cpp:1296:70: warning: '&&' within '||' [-Wlogical-op-parentheses]
                                  if(cur->tok_value == S_RIGHT_PAREN && i != new_entry->num_columns - 1
                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
db.cpp:1296:70: note: place parentheses around the '&&' expression to silence this warning
                                  if(cur->tok_value == S_RIGHT_PAREN && i != new_entry->num_columns - 1
                                                                     ^
                                     (                                                                 )
db.cpp:1297:73: warning: '&&' within '||' [-Wlogical-op-parentheses]
                                     || cur->tok_value != S_RIGHT_PAREN && i == new_entry->num_columns - 1)
                                     ~~ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
db.cpp:1297:73: note: place parentheses around the '&&' expression to silence this warning
                                     || cur->tok_value != S_RIGHT_PAREN && i == new_entry->num_columns - 1)
                                                                        ^
                                        (                                                                 )
db.cpp:1343:68: warning: '&&' within '||' [-Wlogical-op-parentheses]
                                if(cur->tok_value == S_RIGHT_PAREN && i != new_entry->num_columns - 1
                                   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
db.cpp:1343:68: note: place parentheses around the '&&' expression to silence this warning
                                if(cur->tok_value == S_RIGHT_PAREN && i != new_entry->num_columns - 1
                                                                   ^
                                   (                                                                 )
db.cpp:1344:71: warning: '&&' within '||' [-Wlogical-op-parentheses]
                                   || cur->tok_value != S_RIGHT_PAREN && i == new_entry->num_columns - 1)
                                   ~~ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
db.cpp:1344:71: note: place parentheses around the '&&' expression to silence this warning
                                   || cur->tok_value != S_RIGHT_PAREN && i == new_entry->num_columns - 1)
                                                                      ^
                                      (                                                                 )
42 warnings generated.
Clean up
rm: dbfile.bin: No such file or directory
rm: *.tab: No such file or directory
==========================================================================================

CREATE TABLE statement
------------------------------------------------------------------------------------------

dbfile.bin size = 228
INSERT statement
class.tab size: 1969836803. Number of records: 1
dbfile.bin size = 228
INSERT statement
class.tab size: 1634906483. Number of records: 1
dbfile.bin size = 228
INSERT statement
class.tab size: 1927133546. Number of records: 1
dbfile.bin size = 228
INSERT statement
class.tab size: 1717914218. Number of records: 1
dbfile.bin size = 228
INSERT statement
class.tab size: 1852397931. Number of records: 1
dbfile.bin size = 228
INSERT statement
class.tab size: 1986111598. Number of records: 1
dbfile.bin size = 228
INSERT statement
class.tab size: 1853187429. Number of records: 1
dbfile.bin size = 228
INSERT statement
class.tab size: 1675347322. Number of records: 1
dbfile.bin size = 228
INSERT statement
class.tab size: -490028183. Number of records: 106
dbfile.bin size = 228
INSERT statement
class.tab size: -740705417. Number of records: 1
------------------------------------------------------------------------------------------

total 32872
drwxr-xr-x@ 11 nhuluong  staff       352 Apr  6 15:19 .
drwxr-xr-x+ 76 nhuluong  staff      2432 Apr  6 15:00 ..
-rw-r--r--@  1 nhuluong  staff      6148 Apr  4 17:08 .DS_Store
drwxr-xr-x  13 nhuluong  staff       416 Apr  6 15:12 .git
-rw-r--r--   1 nhuluong  staff  16711680 Apr  6 15:19 class.tab
-rwxr-xr-x   1 nhuluong  staff     27556 Apr  6 15:19 db
-rw-r--r--@  1 nhuluong  staff     48108 Apr  6 15:19 db.cpp
-rw-r--r--@  1 nhuluong  staff      6638 Apr  6 15:10 db.h
-rw-r--r--   1 nhuluong  staff       228 Apr  6 15:19 dbfile.bin
-rw-r--r--   1 nhuluong  staff     13838 Apr  6 15:19 test.out
-rw-r--r--   1 nhuluong  staff      2836 Apr  6 15:00 test.sh
------------------------------------------------------------------------------------------

test.sh: line 30:  1502 Segmentation fault: 11  ./db "select * from class"
------------------------------------------------------------------------------------------
==========================================================================================
Error Testing Section
------------------------------------------------------------------------------------------
Setup the table
dbfile.bin size = 228
CREATE TABLE statement
dbfile.bin size = 372
INSERT statement
test.tab size: 1701736195. Number of records: 67108865
dbfile.bin size = 372
INSERT statement
test.tab size: 1870099459. Number of records: 67108865
dbfile.bin size = 372
SELECT statement
test.tab
+----------------+----------------+----------------+
|col1            |col2            |col3            |
+----------------+----------------+----------------+
+----------------+----------------+----------------+
------------------------------------------------------------------------------------------


dbfile.bin size = 372
INSERT statement
Keyword VALUES is missing
Error in the string: (
rc=-199
dbfile.bin size = 372
INSERT statement
Missing ) or the number of columns and insert values don't match
Error in the string: )
rc=-384
------------------------------------------------------------------------------------------


dbfile.bin size = 372
INSERT statement
Type mismatch
Error in the string: string
rc=-382
------------------------------------------------------------------------------------------


dbfile.bin size = 372
INSERT statement
Not Null constraint exists for column name col3
Error in the string: NULL
rc=-380
------------------------------------------------------------------------------------------
End of test1.sh
